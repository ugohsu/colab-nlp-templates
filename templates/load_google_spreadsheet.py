# ============================================================
# Google スプレッドシートを Colab から読み込む（基本テンプレ）
# ============================================================

# ------------------------------------------------------------
# 1. 読み込み対象のスプレッドシート情報（★要編集）
# ------------------------------------------------------------

# スプレッドシートの URL
# ※ 「閲覧可」以上の権限が必要
sheet_url = ""

# 読み込みたいワークシート（タブ）の名前
sheet_name = ""


# ------------------------------------------------------------
# 2. Google アカウント認証（Colab セッションごとに1回）
# ------------------------------------------------------------
# 実行すると、Google アカウントへのログインを求められます
from google.colab import auth
auth.authenticate_user()


# ------------------------------------------------------------
# 3. 必要なライブラリの import
# ------------------------------------------------------------
import pandas as pd
import gspread
from gspread_dataframe import get_as_dataframe
from google.auth import default


# ------------------------------------------------------------
# 4. 認証情報を取得し、gspread クライアントを作成
# ------------------------------------------------------------
# Colab 環境では google.auth.default() が自動的に認証情報を取得します
creds, _ = default()
gc = gspread.authorize(creds)


# ------------------------------------------------------------
# 5. スプレッドシート → DataFrame
# ------------------------------------------------------------

# スプレッドシートを URL で開き、指定したワークシートを取得
worksheet = gc.open_by_url(sheet_url).worksheet(sheet_name)

# ワークシートの内容を Pandas DataFrame に変換
# header=0 は「1行目を列名として使う」ことを意味します
df = get_as_dataframe(worksheet, header=0)
